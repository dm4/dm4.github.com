<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: security | blog.dm4.tw]]></title>
  <link href="http://blog.dm4.tw/blog/categories/security/atom.xml" rel="self"/>
  <link href="http://blog.dm4.tw/"/>
  <updated>2012-07-26T14:58:48+08:00</updated>
  <id>http://blog.dm4.tw/</id>
  <author>
    <name><![CDATA[dm4]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[HITCON 2012 Wargame Notes - Part 2]]></title>
    <link href="http://blog.dm4.tw/blog/2012/07/26/hitcon-2012-wargame-notes-part-2/"/>
    <updated>2012-07-26T14:21:00+08:00</updated>
    <id>http://blog.dm4.tw/blog/2012/07/26/hitcon-2012-wargame-notes-part-2</id>
    <content type="html"><![CDATA[<h3>Web 5</h3>

<p>結果回家研究了一下，終於把 Web 5 也解出來了！好後悔在 HITCON 花太多時間在看
<a href="http://www.youtube.com/watch?v=l2dvg3KJoPo">駭客觀察日記</a> 啊啊啊 orz</p>

<p>這題的 <a href="http://www.exploit-db.com/wp-content/themes/exploit/docs/19527.pdf">提示二</a>
出來之後，可以發現長檔名的檔案/資料夾會因為 <code>~</code> 的縮寫而 disclosure ，所以可以寫個
<a href="https://gist.github.com/3180618">script</a> 來踹，或是用 hint 裡有提到的 <a href="http://code.google.com/p/iis-shortname-scanner-poc/">iis-shortname-scanner-poc</a></p>

<p>不過試了之後發現 file disclosure 只限於有 <code>~</code> 的長檔名，
如果只是 6, 7 個字的檔案/資料夾是不會被套用縮寫的規則，所以也就踹不出來，
在 HITCON 的時候我們就是卡在這裡。</p>

<p>回家再查了多一點資料的時候，看到更多有關 <a href="http://scilnet.fortlewis.edu/tech/NT-Server/File_Names.htm">8.3 Filename</a>
的介紹，其中提到：</p>

<blockquote><p>To disable short filename support, use the registration database editor, REGEDT32.EXE,
and search the HKEY_LOCAL_MACHINE section for the entry HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\FileSystem.
Change the value of the parameter NtfsDisable8dot3NameCreation to a value of 1 (one),
and then short filename generation will be disabled.</p></blockquote>

<p>所以就想到去試一下 <a href="http://wg2.hack.idv.tw:2012/HKEY_LOCAL_MACHINE/System/CurrentControlSet/Control/FileSystem/NtfsDisable8dot3NameCreation/key.txt">http://wg2.hack.idv.tw:2012/HKEY_LOCAL_MACHINE/System/CurrentControlSet/Control/FileSystem/NtfsDisable8dot3NameCreation/key.txt</a>
沒想到就...... orz</p>
]]></content>
  </entry>
  
</feed>
